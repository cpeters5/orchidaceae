{% load static %}
{% include "base.html" %}
<style>
    ul{
        padding-left:30px;
        line-height: 30px;
        list-style-type:square;
    }
    li {
            display: list-item;
    }
    .card-body {
        font-size: 15px;
    }
</style>
<br>

<div class="container-fluid" style="min-height:200px;">
    <div style="clear:both"></div>
    <div class="row">
        <div class="d-none d-sm-block col-sm-3 col-lg-2 ">
            {% include "side_home.html" %}
        </div>

        <div class="col-sm-8 col-lg-9" style="margin-top:7px;">

            <div class="card mt-3">
                <div class="card-header">
                    <h6 class="card-title" style="margin-bottom: 0"><a href="{% url 'orchidaceae:browse' %}?role={{role}}&type={{image.pid.pid.type}}&display=checked">OrchidRoots V.3.1 - 2020-10-01</a></h6>
                </div>

                <div class="card-body" style="padding:20px;">
                <h6 class="mb-0">Database migration</h6>
                Assuming the current production database is to be deployed to the beta database.  The beta contains an old snapshot data + new data generated by new development.
                The new development for R4 is accounts, allauth.account, and social media.

                <ul>
                    <li>Makesure the database is current. Compare and merge prod models file with beta model files for all apps (accounts and orchidaceae).
                        Then run makemigration and migrate to bring both schema to the same structure</li>
                    <li>Backup database and also Export to ~/db/yyyymmdd/</li>
                    <li>Restrore to a new database in new server</li>
                    <li>django:
                        <ul>
                            <li>sites: (prod)</li>
                            <li>sessions (empty)</li>
                            <li>adminLog (empty)</li>
                            <li>migration (beta)</li>
                            <li>contentType (beta)</li>
                        </ul>
                    </li>
                    <li>Auth:  (Not used)
                        <ul>
                            <li>group</li>
                            <li>permission</li>
                            <li>group_permission ref: group, permission</li>
                            <li>user</li>
                            <li>user_group ref: user, group</li>
                            <li>user_group_permission ref: user, group, permission</li>
                        </ul>
                    </li>
                    <li>Accounts: Copy tables in the following order
                        <ul>
                            <li>Tier (beta)</li>
                            <li>Country (beta)</li>
                            <li>User (prod)</li>
                            <li>Donation ref: User (beta)</li>
                            <li>Photographer ref: User (prod)</li>
                            <li>Profile ref: User, Photographer (prod)</li>
                        </ul>
                    </li>
                    <li>Account:
                        <ul>
                            <li>emailaddress ref: User (prod)</li>
                            <li>emailaddress_confirmation ref: User, emailaddress (prod)</li>
                        </ul>
                    </li>
                    <li>Socialaccount: Check all keys are current in the .env file
                        <ul>
                            <li>socialaccount ref: User (beta)</li>
                            <li>socialapp: (beta)</li>
                            <li>socialappsites ref: socialapp, django_sites (beta)</li>
                            <li>socialtoken: ref: socialaccount, socialapp (beta)</li>
                        </ul>
                    </li>
                    <li>Orchiddb:
                        <ul>
                            <li>family</li>
                            <li>subfamily - ref: family</li>
                            <li>tribe - ref: family, subfamily</li>
                            <li>subtribe - ref: family, subfamily, tribe</li>
                            <li>genus - ref: family, subfamily, trie, subtribe</li>
                            <li>genusrelation - ref: genus</li>
                            <li>gensyn - ref: genus</li>
                            <li>infragen - ref: genus</li>
                            <li>subgenus - ref: genus</li>
                            <li>section - ref: genus, subgenus</li>
                            <li>subsection - ref: genus, section, subsection</li>
                            <li>series - ref: genus</li>
                            <li>intragen - ref: genus, subfamily, tribe, subtribe, subgenus, section, subsection, series</li>
                            <li>infragenspc - ref: genus, species, subgenus, section, subsection, series</li>
                            <li>alliance - ref: genus, genus</li>
                            <li>species - </li>
                            <li>reidentifyspecies - ref: species, user</li>
                            <li>specieshistory - ref: species</li>
                            <li>accepted - ref: user, genus, species, subgenus, section, sbsection, series</li>
                            <li>hybrid - ref: genus, species, user</li>
                            <li>synonym - ref: genus, species</li>
                            <li>similarity - ref: species</li>
                            <li>infragenhybrid - ref: species</li>
                            <li>comment - ref: user, species</li>
                            <li>ancestordescendant - ref: species, hybrid</li>
                            <li>culture - ref: species</li>
                            <li>continebt</li>
                            <li>region - ref: continent</li>
                            <li>subregion - ref: continent, region</li>
                            <li>localregion - ref: continent, region, subregion</li>
                            <li>distribution - ref: genus, species, continent, region, subregion, localregion</li>
                            <li>geolocation</li>
                            <li>spcimages - ref: genus, accepted, user, photographer</li>
                            <li>hybimages - ref: genus, hybrid, user, photographer</li>
                            <li>spcimghistory - ref: accepted, user</li>
                            <li>hybimghistory - ref: hybrid, user</li>
                            <li>uploadfile - ref: species, user, photographer</li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
